package-install "openssh-server";

if target_os() ~~ m/ubuntu/ or target_os() ~~ m/debian/ {

  package-install "software-properties-common";

  bash 'add-apt-repository "deb http://ppa.launchpad.net/webupd8team/java/ubuntu xenial main"';

  bash 'apt-get update';
  
  package-install 'oracle-java8-installer';
}

service-start "ssh";

user "spark";

directory "/home/spark/.ssh", %(
  mode  => 700,
  owner => "spark",
  group => "spark"
);

file '/home/spark/.ssh/authorized_keys', %(
  owner   => "spark",
  group   => "spark",
  mode    => 640,
  content => ( slurp 'id_rsa.pub' )
);


EVALFILE "sparrowfile-all";


